<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - QARent</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/style-safe.css">
</head>
<body>

<!-- ===== CHECK ADMIN ===== -->
<script>
  const CURRENT_USER = JSON.parse(localStorage.getItem("currentUser"));
  if (!CURRENT_USER || CURRENT_USER.role !== "admin") {
    alert("Báº¡n khÃ´ng cÃ³ quyá»n truy cáº­p trang nÃ y");
    window.location.href = "login.html";
  }
</script>

<!-- ===== NAVBAR ===== -->
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand fw-bold" href="index.html">QARent Admin</a>
    <div>
      <a href="index.html" class="btn btn-light me-2">Trang chá»§</a>
      <a href="dashboard.html" class="btn btn-light active me-2">Dashboard</a>
      <a href="#" class="btn btn-light" onclick="logout()">ÄÄƒng xuáº¥t</a>
      <a href="admin-bookings.html" class="btn btn-warning">ğŸ“„ Duyá»‡t há»“ sÆ¡</a>
    </div>
  </div>
</nav>

<section class="container pb-5">
  <h4 class="fw-bold mb-3">âš™ï¸ Chá»©c nÄƒng quáº£n trá»‹</h4>

  <div class="row">
    <div class="col-md-4 mb-3">
      <a href="admin-assets.html" class="card p-4 text-center text-decoration-none">
        <h5>ğŸ“¦ Quáº£n lÃ½ tÃ i sáº£n</h5>
        <p class="text-muted mb-0">ThÃªm, sá»­a, xÃ³a tÃ i sáº£n</p>
      </a>
    </div>

    <div class="col-md-4 mb-3">
      <div class="card p-4 text-center">
        <h5>ğŸ‘¤ Quáº£n lÃ½ ngÆ°á»i dÃ¹ng</h5>
        <p class="text-muted mb-0">(MÃ´ táº£ trong bÃ¡o cÃ¡o)</p>
      </div>
    </div>

    <div class="col-md-4 mb-3">
      <div class="card p-4 text-center">
        <h5>ğŸ“„ Quáº£n lÃ½ há»£p Ä‘á»“ng</h5>
        <p class="text-muted mb-0">Duyá»‡t & theo dÃµi</p>
      </div>
    </div>
  </div>
</section>

<!-- ===== HEADER ===== -->
<section class="container py-5">
  <h1 class="fw-bold">ğŸ“Š Dashboard quáº£n trá»‹</h1>
  <p class="text-muted">Quáº£n lÃ½ há»‡ thá»‘ng cho thuÃª tÃ i sáº£n</p>
</section>

<!-- ===== STATS ===== -->
<section class="container pb-4">
  <div class="row">

    <div class="col-md-3 mb-3">
      <div class="card p-4 text-center">
        <h6>Tá»•ng tÃ i sáº£n</h6>
        <h2 class="fw-bold text-primary">12</h2>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card p-4 text-center">
        <h6>Há»£p Ä‘á»“ng thuÃª</h6>
        <h2 class="fw-bold text-success">5</h2>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card p-4 text-center">
        <h6>NgÆ°á»i dÃ¹ng</h6>
        <h2 class="fw-bold text-warning">8</h2>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card p-4 text-center">
        <h6>Doanh thu (Æ°á»›c tÃ­nh)</h6>
        <h2 class="fw-bold text-danger">--</h2>
      </div>
    </div>

  </div>
</section>

<!-- ===== CONTRACT LIST ===== -->
<section class="container pb-5">
  <h4 class="fw-bold mb-3">ğŸ“„ Danh sÃ¡ch há»£p Ä‘á»“ng thuÃª</h4>

  <div class="card p-3">
    <table class="table table-bordered mb-0">
      <thead>
        <tr>
          <th>KhÃ¡ch thuÃª</th>
          <th>Email</th>
          <th>TÃ i sáº£n</th>
          <th>Thá»i gian</th>
          <th>Tráº¡ng thÃ¡i</th>
          <th>HÃ nh Ä‘á»™ng</th>
        </tr>
      </thead>
      <tbody id="contractTable">
        <tr>
          <td colspan="5" class="text-center text-muted">
            ChÆ°a cÃ³ dá»¯ liá»‡u
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<!-- ===== SCRIPT ===== -->
<script>
function logout() {
  localStorage.removeItem("currentUser");
  localStorage.removeItem("access_token");
  window.location.href = "login.html";
}

/* DEMO dá»¯ liá»‡u há»£p Ä‘á»“ng tá»« localStorage */
const contracts = JSON.parse(localStorage.getItem("contracts")) || [];
const table = document.getElementById("contractTable");

if (contracts.length > 0) {
  table.innerHTML = "";
  contracts.forEach((c, index) => {
    table.innerHTML += `
      <tr>
        <td>${c.user}</td>
        <td>${c.userEmail}</td>
        <td>${c.asset}</td>
        <td>${c.start} â†’ ${c.end}</td>
        <td>
          <span class="badge ${
            c.status === "ÄÃ£ duyá»‡t"
              ? "bg-success"
              : c.status === "Tá»« chá»‘i"
              ? "bg-danger"
              : "bg-warning"
          }">
            ${c.status}
          </span>
        </td>
        <td>
          ${
            c.status === "Chá» duyá»‡t"
              ? `
                <button class="btn btn-success btn-sm me-1"
                        onclick="approveContract(${index})">
                  Duyá»‡t
                </button>
                <button class="btn btn-danger btn-sm"
                        onclick="rejectContract(${index})">
                  Tá»« chá»‘i
                </button>
              `
              : "-"
          }
        </td>
      </tr>
    `;
  });

  function approveContract(index) {
  const contracts = JSON.parse(localStorage.getItem("contracts")) || [];
  contracts[index].status = "ÄÃ£ duyá»‡t";
  localStorage.setItem("contracts", JSON.stringify(contracts));
  location.reload();
}

function rejectContract(index) {
  const contracts = JSON.parse(localStorage.getItem("contracts")) || [];
  contracts[index].status = "Tá»« chá»‘i";
  localStorage.setItem("contracts", JSON.stringify(contracts));
  location.reload();
}

}
</script>

</body>
</html>
